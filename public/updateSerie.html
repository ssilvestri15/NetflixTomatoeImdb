<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Add new serie</title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
  <h1 class="mb-4">Add New Film</h1>
  <form action="/updateSerieTV" method="post">

    <div class="mb-3" hidden="hidden">
      <label for="serieId" class="form-label">ID:</label>
      <input type="text" id="serieId" name="_id">
    </div>

    <div class="mb-3">
      <label for="title" class="form-label">Title:</label>
      <input type="text" class="form-control" id="title" name="title">
    </div>

    <div class="mb-3">
      <label for="release_date" class="form-label">Release Date:</label>
      <input type="number" class="form-control" id="release_date" name="release_date">
    </div>

    <div class="mb-3">
      <label for="rotten_rating" class="form-label">Rotten Rating:</label>
      <input type="text" class="form-control" id="rotten_rating" name="rotten_rating">
    </div>

    <div class="mb-3">
      <label for="imdb_rating" class="form-label">IMDB Rating:</label>
      <input type="text" class="form-control" id="imdb_rating" name="imdb_rating">
    </div>

    <div class="mb-3">
      <label for="platforms" class="form-label">Platforms:</label>
      <input type="text" class="form-control" id="platforms" name="platforms">
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
</div>

<script>
    // Funzione per estrarre i parametri dall'URL
    function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&');
    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
    const results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
  }

    const idInput = document.getElementById('serieId');
    const titleInput = document.getElementById('title');
    const releaseDateInput = document.getElementById('release_date');
    const rottenRatingInput = document.getElementById('rotten_rating');
    const imdbRatingInput = document.getElementById('imdb_rating');
    const platformsInput = document.getElementById('platforms');

    // Ottieni i dati passati dall'URL
    const encodedData = getParameterByName('data');
    const data = JSON.parse(decodeURIComponent(encodedData));

    console.error(data)

    // Popola il modulo con i dati
    idInput.value = data._id
    titleInput.value = data.title;
    releaseDateInput.value = data.release_date;
    rottenRatingInput.value = data.ratings.rotten_rating.replace("/100", "");
    imdbRatingInput.value = data.ratings.imdb_rating.replace("/10", "");
    platformsInput.value = data.platforms

</script>

</body>
</html>
