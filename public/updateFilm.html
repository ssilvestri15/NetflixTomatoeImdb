<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Update film</title>
  <!-- Aggiungi il link al CSS di Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
  <h1 class="mb-4">Update Film</h1>
  <form action="/updateItem" method="post">


    <div class="mb-3" hidden="hidden">
      <label for="name" class="form-label">Name:</label>
      <input type="text" id="movieId" name="_id">
    </div>

    <div class="mb-3">
      <label for="name" class="form-label">Name:</label>
      <input type="text" class="form-control" id="name" name="name">
    </div>

    <div class="mb-3">
      <label for="info" class="form-label">Info:</label>
      <textarea class="form-control" id="info" name="info" rows="4"></textarea>
    </div>

    <div class="mb-3">
      <label for="genres" class="form-label">Genres:</label>
      <input type="text" class="form-control" id="genres" name="genres">
    </div>

    <div class="mb-3">
      <label for="directors" class="form-label">Directors:</label>
      <input type="text" class="form-control" id="directors" name="directors">
    </div>

    <div class="mb-3">
      <label for="authors" class="form-label">Authors:</label>
      <input type="text" class="form-control" id="authors" name="authors">
    </div>

    <div class="mb-3">
      <label for="release_date" class="form-label">Release Date:</label>
      <input type="date" class="form-control" id="release_date" name="release_date">
    </div>

    <div class="mb-3">
      <label for="runtime" class="form-label">Runtime:</label>
      <input type="text" class="form-control" id="runtime" name="runtime">
    </div>

    <div class="mb-3">
      <label for="production_company" class="form-label">Production Company:</label>
      <input type="text" class="form-control" id="production_company" name="production_company">
    </div>

    <div class="mb-3">
      <label for="rotten_rating" class="form-label">Rotten Rating:</label>
      <input type="text" class="form-control" id="rotten_rating" name="rotten_rating">
    </div>

    <div class="mb-3">
      <label for="netflix_rating" class="form-label">Netflix Rating:</label>
      <input type="text" class="form-control" id="netflix_rating" name="netflix_rating">
    </div>

    <div class="mb-3">
      <label for="imdb_rating" class="form-label">IMDB Rating:</label>
      <input type="text" class="form-control" id="imdb_rating" name="imdb_rating">
    </div>
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
</div>

<script>
  // Funzione per estrarre i parametri dall'URL
  function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&');
    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
    const results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
  }

  const idInput = document.getElementById('movieId');
  const nameInput = document.getElementById('name');
  const infoInput = document.getElementById('info');
  const genresInput = document.getElementById('genres');
  const directorsInput = document.getElementById('directors');
  const authorsInput = document.getElementById('authors');
  const releaseDateInput = document.getElementById('release_date');
  const runtimeInput = document.getElementById('runtime');
  const productionCompanyInput = document.getElementById('production_company');
  const rottenRatingInput = document.getElementById('rotten_rating');
  const netflixRatingInput = document.getElementById('netflix_rating');
  const imdbRatingInput = document.getElementById('imdb_rating');

  // Ottieni i dati passati dall'URL
  const encodedData = getParameterByName('data');
  const data = JSON.parse(decodeURIComponent(encodedData));

  console.error(data)

  // Popola il modulo con i dati
  idInput.value = data._id
  nameInput.value = data.name;
  infoInput.value = data.info;
  genresInput.value = data.genres;
  directorsInput.value = data.directors;
  authorsInput.value = data.authors;
  releaseDateInput.value = data.release_date;
  runtimeInput.value = data.runtime;
  productionCompanyInput.value = data.production_company;
  rottenRatingInput.value = data.ratings.rotten_rating;
  netflixRatingInput.value = data.ratings.netflix_rating;
  imdbRatingInput.value = data.ratings.imdb_rating;

</script>


<!-- Aggiungi il link al JavaScript di Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
